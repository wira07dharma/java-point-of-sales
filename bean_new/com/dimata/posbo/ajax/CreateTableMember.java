/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package com.dimata.posbo.ajax;
import com.dimata.posbo.entity.masterdata.MemberReg;
import com.dimata.posbo.entity.search.SrcMemberReg;
import com.dimata.posbo.session.masterdata.SessMemberReg;
import com.dimata.qdep.form.FRMQueryString;
import java.util.Vector;
import javax.servlet.http.HttpServlet;
import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
/**
 *
 * @author dimata005
 */

public class CreateTableMember extends HttpServlet{
     /* Generated by Together */
    public void init(ServletConfig config) throws ServletException {
        super.init(config);
    }

    /** Destroys the servlet.
     */
    public void destroy() {

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, java.io.IOException {
        processRequest(request, response);
    }

    /** Handles the HTTP <code>POST</code> method.
     * @param request servlet request
     * @param response servlet response
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, java.io.IOException {
        processRequest(request, response);
    }

    /** Returns a short description of the servlet.
     */
    public String getServletInfo() {
        return "Short description";
    }

    private void processRequest(HttpServletRequest request, HttpServletResponse response) {
        try{
            //String buffer="false";
            /**
             * create fungsi check contract price with oidsupplier and oidmaterial
             */
            String key = FRMQueryString.requestString(request,"key");

            String comboBox="";
            String whereRoom = "";
            SrcMemberReg srcMemberReg = new SrcMemberReg();
            srcMemberReg.setName(key);
            Vector listMemberReg = SessMemberReg.searchMemberReg(srcMemberReg,0,5); //PstBillMain.listOpenBill(0, 0,whereOpenBill, "");
            try{
                   comboBox=comboBox+"<div class=row>";
                                comboBox=comboBox+"<table role=\"grid\" class=\"tablesorter-dropbox tablesorter hasFilters\">";
                                    comboBox=comboBox+"<thead>";
                                        comboBox=comboBox+"<tr role=\"row\" class=\"tablesorter-headerRow\">";
                                            comboBox=comboBox+"<th aria-label=\"#: Ascending sort applied, activate to apply a descending sort\" aria-sort=\"ascending\" style=\"-moz-user-select: none;\" unselectable=\"on\" aria-disabled=\"false\" role=\"columnheader\" scope=\"col\" tabindex=\"0\" class=\"tablesorter-header tablesorter-headerAsc\" data-column=\"0\" width=\"10%\"><div class=\"tablesorter-header-inner\">Nama<i class=\"tablesorter-icon\"></i></div></th>";
                                            comboBox=comboBox+"<th aria-label=\"Guest Name: No sort applied, activate to apply an ascending sort\" aria-sort=\"none\" style=\"-moz-user-select: none;\" unselectable=\"on\" aria-disabled=\"false\" role=\"columnheader\" scope=\"col\" tabindex=\"0\" class=\"tablesorter-header tablesorter-headerUnSorted\" data-column=\"1\" width=\"50%\"><div class=\"tablesorter-header-inner\">Perusahaan<i class=\"tablesorter-icon\"></i></div></th>";
                                        comboBox=comboBox+"</tr>";
                                    comboBox=comboBox+"</thead>";
                                    comboBox=comboBox+"<tfoot>";
                                        comboBox=comboBox+"<tr>";
                                            comboBox=comboBox+"<th class=\"tablesorter-headerAsc\" data-column=\"0\" width=\"50%\">Name</th>";
                                            comboBox=comboBox+"<th data-column=\"1\" width=\"50%\">Company</th>";
                                        comboBox=comboBox+"</tr>";
                                    comboBox=comboBox+"</tfoot>";
                                    comboBox=comboBox+"<tbody aria-relevant=\"all\" aria-live=\"polite\">";
                                        int start = 0;
                                        for(int i = 0; i < listMemberReg.size(); i++) {
                                           Vector temp = (Vector)listMemberReg.get(i);
                                           MemberReg memberReg = (MemberReg)temp.get(0);
                                           start = start + 1;
                                           String name = "";
                                            if(memberReg.getPersonName()!=null&&memberReg.getPersonName().length()>0)
                                            {
                                                    name = memberReg.getPersonName();
                                            }
                                            else
                                            {
                                                    name = memberReg.getCompName();
                                            }
                                            comboBox=comboBox+"<tr style=\"\" class=\"tablesorter-hasChildRow odd\">";
                                                comboBox=comboBox+"<td align=\"left\"><a href=\"javascript:cmdCheckGuest('"+name+"','"+memberReg.getCompName()+"','"+memberReg.getOID()+"','"+memberReg.getNationality()+"')\">"+name+"</a></td>";
                                                comboBox=comboBox+"<td align=\"left\"><a href=\"javascript:cmdCheckGuest('"+name+"','"+memberReg.getCompName()+"','"+memberReg.getOID()+"','"+memberReg.getNationality()+"')\">"+memberReg.getCompName()+"</a></td>";
                                            comboBox=comboBox+"</tr>";
                                        }
                                    comboBox=comboBox+"</tbody>";
                                comboBox=comboBox+"</table>";
                             comboBox=comboBox+"</div>";
            }catch(Exception ex){
                comboBox="";
            }
            
            response.getWriter().println(comboBox);

         }catch(Exception ex){
            ex.printStackTrace();
         }
    }
}